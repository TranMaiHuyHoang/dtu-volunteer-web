<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tạo dự án</title>
</head>
<body>
    <main>
        <h1>Tạo dự án</h1>
        <div>
            <a href="/projects/list"><button>← Quay lại danh sách</button></a>
        </div>
        <div id="message"></div>
        
        <form id="projectForm" onsubmit="createProject(event)">
            <div>
                <label>Tiêu đề: <input type="text" name="title" required></label>
            </div>
            <div>
                <label>Mô tả: <textarea name="description"></textarea></label>
            </div>
            <div>
                <label>Địa điểm: <input type="text" name="location"></label>
            </div>
            <div>
                <label>Ngày bắt đầu: <input type="date" name="startDate"></label>
            </div>
            <div>
                <label>Ngày kết thúc: <input type="date" name="endDate"></label>
            </div>
            <button type="submit">Tạo dự án</button>
        </form>
    </main>

    <script src="/js/utils/fetchApi.js"></script>
    <script src="/js/utils/promiseHelper.js"></script>
    <script src="/js/utils/fetchHelper.js"></script>
    <script src="/js/layout.js"></script>
    <script>
        async function createProject(event) {
            event.preventDefault();
            const form = event.target;
            
            const data = {
                title: form.title.value.trim(),
                description: form.description.value.trim(),
                location: form.location.value.trim(),
                startDate: form.startDate.value || null,
                endDate: form.endDate.value || null
            };
            
            setElementContent('message', 'Đang tạo...');
            
            const [error, res] = await to(
                fetchApi('/projects', 'POST', data, '', { useSession: true })
            );
            
            if (error) {
                setElementContent('message', 'Lỗi: ' + error.message);
            } else {
                setElementContent('message', res.message || 'Tạo dự án thành công!');
                form.reset();
            }
        }
    </script>
</body>
</html>

