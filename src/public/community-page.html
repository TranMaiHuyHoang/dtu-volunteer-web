<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K·∫øt N·ªëi C·ªông ƒê·ªìng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #3b82f6; 
            --secondary-color: #10b981; 
            --border-color: #e5e7eb;
            --background-color: #f3f4f6;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px 0;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 20px;
        }

        h1 {
            color: #1f2937;
            font-size: 2em;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }

        .community-layout {
            display: grid;
            grid-template-columns: 1fr 3fr; 
            gap: 30px;
        }

        .sidebar-panel {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .sidebar-panel h3 {
            font-size: 1.1em;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }
        
        .group-list li {
            list-style: none;
            padding: 8px 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
        }

        .group-list li:hover {
            background-color: #eff6ff; 
            color: var(--primary-color);
        }

        .member-count {
            background-color: #e5e7eb;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
        }

        .nav-quick li {
            list-style: none;
            padding: 8px 10px;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .nav-quick li:hover {
            background-color: #ecfdf5; 
            color: var(--secondary-color);
        }
        
        /*Khu v·ª±c ƒêƒÉng b√†i m·ªõi */
        .post-form {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--primary-color);
            margin-bottom: 30px;
        }

        .post-textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            resize: vertical;
            min-height: 100px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .post-form-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .btn-post {
            background-color: var(--primary-color);
            color: white;
            padding: 8px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .btn-post:hover {
            background-color: #2563eb;
        }

        .post-card {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            background-color: #bfdbfe; 
            color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin-right: 10px;
        }

        .post-user-info p {
            margin: 0;
            font-size: 0.9em;
        }

        .post-user-info .user-name {
            font-weight: bold;
            color: #1f2937;
        }

        .post-user-info .post-time {
            color: #6b7280;
            font-size: 0.8em;
        }

        .post-content {
            margin-bottom: 15px;
            color: #374151;
        }

        .post-tag {
            display: inline-block;
            background-color: #ccfbf1; 
            color: #0d9488;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75em;
            margin-right: 5px;
        }

        .post-actions {
            border-top: 1px solid var(--border-color);
            padding-top: 10px;
            display: flex;
            gap: 20px;
            font-size: 0.9em;
        }

        .post-actions button {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            transition: color 0.2s;
        }

        .post-actions button:hover {
            color: var(--primary-color);
        }

        @media (max-width: 900px) {
            .community-layout {
                grid-template-columns: 1fr;
            }
        }
        /* --- CSS cho √î B√¨nh Lu·∫≠n (Comment Box) --- */
        .comment-section {
            margin-top: 15px;
            border-top: 1px solid #f3f4f6;
            padding-top: 10px;
        }

        .comment-input-area {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .comment-input {
            flex-grow: 1;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 20px; 
            font-size: 0.9em;
        }

        .btn-send {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            padding: 8px;
}
    </style>
</head>
<body>
	<script type="module" src="/js/layout.js"></script>
    <div class="container">
        <h1> K·∫æT N·ªêI C·ªòNG ƒê·ªíNG</h1>

        <div class="community-layout">
            
            <div class="sidebar">
                
                <div class="sidebar-panel">
                    <h3 style="color: var(--primary-color);"><i class="fa-solid fa-people-group"></i> Nh√≥m & D·ª± √°n C·ªßa T√¥i</h3>
                    <ul class="group-list" id="groupList">
                        </ul>
                    <button class="btn-post" style="width: 100%; margin-top: 15px; background-color: var(--secondary-color);">
                        Xem t·∫•t c·∫£ Nh√≥m
                    </button>
                </div>

                <div class="sidebar-panel">
                    <h3 style="color: var(--secondary-color);"><i class="fa-solid fa-bolt"></i> ƒêi·ªÅu h∆∞·ªõng nhanh</h3>
                    <ul class="nav-quick">
                        <li><i class="fa-solid fa-plus-circle"></i> T·∫°o B√†i vi·∫øt m·ªõi</li>
                        <li><i class="fa-solid fa-book"></i> Xem H∆∞·ªõng d·∫´n</li>
                        <li><i class="fa-solid fa-bell"></i> Th√¥ng b√°o t·ª´ Admin</li>
                    </ul>
                </div>
            </div>

            <div class="main-content-feed">
                
                <div class="post-form">
                    <h3 style="color: #374151; font-size: 1.25em;"><i class="fa-solid fa-pencil"></i> ƒêƒÉng B√†i M·ªõi</h3>
                    <textarea id="newPostContent" class="post-textarea" 
                              placeholder="B·∫°n ƒëang nghƒ© g√¨? Chia s·∫ª kinh nghi·ªám ho·∫∑c t√¨m ki·∫øm s·ª± tr·ª£ gi√∫p..."></textarea>
                    
                    <div class="post-form-footer">
                        <span style="font-size: 0.9em; color: #6b7280;">ƒêƒÉng l√™n: C·ªông ƒë·ªìng chung</span>
                        <button id="btnPostSubmit" class="btn-post">
                            ƒêƒÉng B√†i
                        </button>
                    </div>
                </div>

                <h2 style="font-size: 1.5em; color: #1f2937; margin-bottom: 20px;"><i class="fa-solid fa-message"></i> D√≤ng Th·∫£o Lu·∫≠n M·ªõi Nh·∫•t</h2>
                
                <div id="postsFeed" class="posts-feed">
                    </div>
                
                <div id="loadingMessage" style="text-align:center; padding: 20px; color: #6b7280; display: none;">ƒêang t·∫£i b√†i vi·∫øt...</div>
                <div id="emptyMessage" style="text-align:center; padding: 20px; color: #6b7280; display: none;">Ch∆∞a c√≥ b√†i vi·∫øt n√†o.</div>
            </div>
        </div>
    </div>

<script>
    // D·ªØ li·ªáu m·∫´u
    const mockGroups = [
        { id: 1, name: 'Nh√≥m M√¥i Tr∆∞·ªùng Xanh', members: 1200 },
        { id: 2, name: 'CLB D·∫°y K√®m Mi·ªÖn Ph√≠', members: 850 },
        { id: 3, name: 'Designer T√¨nh Nguy·ªán', members: 420 },
    ];

    const mockPosts = [
        { id: 101, user: 'Ho√†ng Mai', content: 'T√¨m th√†nh vi√™n cho d·ª± √°n d·ªçn d·∫πp b√£i bi·ªÉn ƒê√† N·∫µng v√†o cu·ªëi tu·∫ßn n√†y! Ai tham gia inbox nh√©!', tags: ['M√¥i tr∆∞·ªùng', 'ƒê√† N·∫µng'], likes: 55, comments: 12 },
        { id: 102, user: 'Minh Th∆∞', content: 'C√≥ ai c√≥ kinh nghi·ªám t·ªï ch·ª©c s·ª± ki·ªán g√¢y qu·ªπ kh√¥ng ·∫°? Em c·∫ßn l·ªùi khuy√™n v·ªÅ kh√¢u truy·ªÅn th√¥ng.', tags: ['S·ª± ki·ªán', 'H·ªèi ƒë√°p'], likes: 30, comments: 5 },
        { id: 103, user: 'Admin DTU', content: 'üî• S·ª± ki·ªán t√¨nh nguy·ªán l·ªõn nh·∫•t th√°ng 12 s·∫Øp di·ªÖn ra! ƒêƒÉng k√Ω ngay!', tags: ['Th√¥ng b√°o', 'Hot'], likes: 98, comments: 25 },
    ];

    // H√†m render

    function renderGroupSidebar(groups) {
        const list = document.getElementById('groupList');
        list.innerHTML = '';
        groups.forEach(group => {
            const li = document.createElement('li');
            li.innerHTML = `
                <span><i class="fa-solid fa-users mr-2"></i> ${group.name}</span>
                <span class="member-count">${group.members} TV</span>
            `;
            list.appendChild(li);
        });
    }

    function renderPosts(posts) {
        const feed = document.getElementById('postsFeed');
        const emptyMessage = document.getElementById('emptyMessage');
        feed.innerHTML = '';
        
        if (posts.length === 0) {
            emptyMessage.style.display = 'block';
            return;
        }
        emptyMessage.style.display = 'none';

        posts.forEach(post => {
            const postCard = document.createElement('div');
            postCard.className = 'post-card';
            
            const tagsHTML = post.tags.map(tag => 
                `<span class="post-tag">#${tag}</span>`
            ).join('');

            postCard.innerHTML = `
                <div class="post-header">
                    <div class="avatar">${post.user.charAt(0)}</div>
                    <div class="post-user-info">
                        <p class="user-name">${post.user}</p>
                        <p class="post-time">ƒê√£ ƒëƒÉng 2 gi·ªù tr∆∞·ªõc</p>
                    </div>
                </div>
                
                <p class="post-content">${post.content}</p>
                
                <div style="margin-bottom: 10px;">${tagsHTML}</div>

                <div class="post-actions">
                    <button onclick="handleLike(${post.id})">
                        <i class="fa-solid fa-heart"></i> ${post.likes} Th√≠ch
                    </button>
                    <button onclick="toggleCommentSection(${post.id})">
                        <i class="fa-solid fa-comment"></i> ${post.comments} B√¨nh lu·∫≠n
                    </button>
                    <button onclick="handleShare(${post.id})">
                        <i class="fa-solid fa-share"></i> Chia s·∫ª
                    </button>
                </div>

                <div id="commentSection-${post.id}" class="comment-section" style="display: none;">
                    <div class="comment-input-area">
                        <div class="avatar" style="width: 30px; height: 30px; font-size: 0.8em;">B</div> 
                        
                        <input type="text" id="commentInput-${post.id}" class="comment-input" 
                               placeholder="Vi·∫øt b√¨nh lu·∫≠n c·ªßa b·∫°n..." 
                               onkeypress="checkEnterKey(event, ${post.id})">
                               
                        <button class="btn-send" onclick="submitComment(${post.id})">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </div>
                    
                    <div class="comment-list" style="padding-left: 40px; margin-top: 10px; font-size: 0.9em; color: #6b7280;">
                        <p style="margin-bottom: 5px;"><b>Nguy·ªÖn A:</b> √ù t∆∞·ªüng hay qu√°!</p>
                    </div>
                </div>
                `;
            feed.appendChild(postCard);
        });
    }

    // --- H√†m x·ª≠ l√Ω s·ª± ki·ªán --- 

    function handlePostSubmit() {
        const content = document.getElementById('newPostContent').value.trim();
        if (!content) {
            alert('Vui l√≤ng nh·∫≠p n·ªôi dung b√†i vi·∫øt!');
            return;
        }

        // Giao di·ªán (FE) gi·∫£ l·∫≠p:
        const newPost = {
            id: Date.now(),
            user: 'B·∫°n', 
            content: content,
            tags: ['M·ªõi ƒëƒÉng'],
            likes: 0,
            comments: 0
        };

        // Th√™m b√†i vi·∫øt v√†o ƒë·∫ßu danh s√°ch v√† render l·∫°i
        mockPosts.unshift(newPost);
        renderPosts(mockPosts);
        document.getElementById('newPostContent').value = ''; 
        
        alert('B√†i vi·∫øt ƒë√£ ƒë∆∞·ª£c ƒëƒÉng l√™n (local)!');
        
        // TODO: thay b·∫±ng vi·ªác g·ªçi API POST /api/posts
    }

    function handleLike(postId) {
        alert(`B·∫°n ƒë√£ th√≠ch b√†i vi·∫øt ${postId}!`);
        // TODO: g·ªçi API PUT /api/posts/${postId}/like
    }

    function handleShare(postId) {
        alert(`ƒê√£ sao ch√©p li√™n k·∫øt b√†i vi·∫øt ${postId}.`);
    }

    // --- H√ÄM X·ª¨ L√ù B√åNH LU·∫¨N M·ªöI ---
    
    // 1. H√†m chuy·ªÉn ƒë·ªïi hi·ªÉn th·ªã
    function toggleCommentSection(postId) {
        const commentSection = document.getElementById(`commentSection-${postId}`);
        
        // Chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i hi·ªÉn th·ªã
        if (commentSection.style.display === 'none') {
            commentSection.style.display = 'block';
            // Focus v√†o √¥ input ngay sau khi hi·ªán
            document.getElementById(`commentInput-${postId}`).focus();
        } else {
            commentSection.style.display = 'none';
        }
    }

    // 2. H√†m g·ª≠i b√¨nh lu·∫≠n
    function submitComment(postId) {
        const inputElement = document.getElementById(`commentInput-${postId}`);
        const commentContent = inputElement.value.trim();

        if (!commentContent) {
            alert('B√¨nh lu·∫≠n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng.');
            return;
        }

        // X·ª≠ l√Ω g·ª≠i (FE gi·∫£ l·∫≠p)
        alert(`G·ª≠i b√¨nh lu·∫≠n "${commentContent}" t·ªõi b√†i vi·∫øt ${postId}`);
        inputElement.value = ''; // X√≥a n·ªôi dung input

        // TODO: ·ªû ƒë√¢y b·∫°n s·∫Ω g·ªçi API POST /api/posts/${postId}/comment
    }

    // 3. H√†m x·ª≠ l√Ω ph√≠m Enter
    function checkEnterKey(event, postId) {
        // Ki·ªÉm tra xem ph√≠m Enter c√≥ ƒë∆∞·ª£c nh·∫•n (keyCode 13) kh√¥ng
        if (event.key === 'Enter') {
            event.preventDefault(); // NgƒÉn tr√¨nh duy·ªát xu·ªëng d√≤ng
            submitComment(postId);
        }
    }


    document.addEventListener('DOMContentLoaded', () => {
        // Render giao di·ªán l·∫ßn ƒë·∫ßu
        renderGroupSidebar(mockGroups);
        renderPosts(mockPosts);

        // G√°n s·ª± ki·ªán cho n√∫t ƒêƒÉng b√†i
        document.getElementById('btnPostSubmit').addEventListener('click', handlePostSubmit);
    });

</script>
</body>
</html>